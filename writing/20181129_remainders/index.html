<!DOCTYPE html><html><head><meta charset="utf-8"><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="Leftovers: What&#39;s the difference between Clojure&#39;s rem(ainder) and mod(ulus) functions?" property="og:title"><title>Leftovers: What&#39;s the difference between Clojure&#39;s rem(ainder) and mod(ulus) functions?</title><meta property="description"><link href="/favicon.ico" rel="icon" type="image/ico"><link href="/styles/styles.css" rel="stylesheet" type="text/css"></head><body><div class="nav"><h1 id="nicki-vanceindexhtml"><a href="/index.html">Nicki Vance</a></h1>
<ul>
  <li><a href="/index.html">Home</a></li>
  <li><a href="/writing/index.html">Writings</a></li>
</ul>
</div><div class="content-background"><div class="content-layout"><div class="postIntro"><h1 id="leftovers-whats-the-difference-between-clojures-remainder-and-modulus-functions">Leftovers: What's the difference between Clojure's rem(ainder) and mod(ulus) functions?</h1>
</div><div class="date"><p>November 29, 2018</p>
</div><div class="postBody"><p>Clojure has two functions for finding the remainder in integer division: <code>rem</code> and <code>mod</code>. Turns out, many other languages also have remainder and modulus functions.</p>

<p>Why? What the heck? What's the difference?</p>

<p>At first blush, these functions seem the same:</p>

<div class="language-clojure highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span>(<span style="color:#080;font-weight:bold">rem</span> <span style="color:#00D">5</span> <span style="color:#00D">3</span>)
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>=&gt; <span style="color:#00D">2</span>
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>(<span style="color:#080;font-weight:bold">mod</span> <span style="color:#00D">5</span> <span style="color:#00D">3</span>)
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>=&gt; <span style="color:#00D">2</span>
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>(<span style="color:#080;font-weight:bold">rem</span> <span style="color:#00D">-5</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>=&gt; <span style="color:#00D">-2</span>
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>(<span style="color:#080;font-weight:bold">mod</span> <span style="color:#00D">-5</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>=&gt; <span style="color:#00D">-2</span>
</pre></div>
</div>
</div>

<p>This sameness only holds when the arguments are <strong>both positive</strong> or <strong>both negative.</strong></p>

<p>Check this out:</p>

<div class="language-clojure highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span><span style="color:#777">;; negative numerator, positive divisor</span>
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>(<span style="color:#080;font-weight:bold">rem</span> <span style="color:#00D">-5</span> <span style="color:#00D">3</span>)
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>=&gt; <span style="color:#00D">-2</span>
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>(<span style="color:#080;font-weight:bold">mod</span> <span style="color:#00D">-5</span> <span style="color:#00D">3</span>)
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>=&gt; <span style="color:#00D">1</span>
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span><span style="color:#777">;; positive numerator, negative divisor</span>
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>(<span style="color:#080;font-weight:bold">rem</span> <span style="color:#00D">5</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>=&gt; <span style="color:#00D">2</span>
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>(<span style="color:#080;font-weight:bold">mod</span> <span style="color:#00D">5</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"><a href="#n13" name="n13">13</a></span>=&gt; <span style="color:#00D">-1</span>
</pre></div>
</div>
</div>

<p>If one of the arguments is negative, we get different results from <code>rem</code> and <code>mod</code>.
Not only that, we get different results <em>within</em> <code>rem</code> and <code>mod</code> depending on whether its the numerator or divisor that is negative.</p>

<p><strong>Why are there two functions? Why isn't there just one way to calculate a remainder like I learned in school? When do you want to use one over the other?</strong></p>

<p>I thought these questions would be easy to answer. There are certainly a lot of answers but not many were complete.</p>

<h2 id="the-first-level-answers">The first level answers</h2>

<p>These are the two most common and useful answers I found:</p>

<ol>
  <li>
    <p><code>mod</code> is different because it returns a remainder that reflects the sign of the divisor.</p>
  </li>
  <li>
    <p><code>mod</code> floors the quotient toward negative infinity while <code>rem</code> truncates the quotient toward zero.</p>
  </li>
</ol>

<p>The first explanation is true and it answers my second question, "When do you want to use <code>rem</code> over <code>mod</code>?" by saying, "Use <code>mod</code> when you want the remainder to have the same sign as the divisor."</p>

<p>This explanation implies that the reason there are two different functions is because you might want the results to be different in these certain cases.</p>

<p>As far as explanations go, it falls flat. What's the motivation? Humans made this! What were they thinking? Is there a Hollywood heist movie behind this - computer programmer replaces <code>rem</code> with <code>mod</code> to siphon off remainders of the stock market?</p>

<p>I disqualify the first explanation because it doesn't satisfy my "why" questions.</p>

<p>The second explanation provides a little more information about the decision (flooring vs truncating) that results in the first explanation.</p>

<p>I'm still not satisfied with "why" we have two ways to calculate the remainder but first, I want to take a quick detour into integer division and the concepts of flooring and truncating.</p>

<h2 id="integer-division-whats-happening-inside-rem-and-mod">Integer division: what's happening inside <code>rem</code> and <code>mod</code></h2>

<p>When I first learned about <code>rem</code> and <code>mod</code>, I was surprised that there are multiple ways to calculate a remainder.</p>

<p>I am much more surprised that I was surprised. I have a math degree, shouldn't I know this? I spent years in elementary school carrying out division and manipulating fractions - why didn't I notice then? Did I forget that I knew this once? I really don't know.</p>

<p>Are <code>rem</code> and <code>mod</code> based on the the division algorithms we learn in school? What did we learn in school?</p>

<p>I learned a simplified version of integer division.</p>

<blockquote>
  <p>The convention is to return the value of x that satisfies the congruence and lies between 0 and m. (<a href="http://mathcentral.uregina.ca/QQ/database/QQ.09.12/h/eric1.html">source</a>)</p>
</blockquote>

<div class="language-clojure highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span><span style="color:#777">;; division: -5/3 = 5/-3 -1.66</span>
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span><span style="color:#777">;; - / + negative numerator, positive divisor</span>
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span><span style="color:#777">;; integer division: -5 = (3 * -1) + (-2)</span>
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>(<span style="color:#080;font-weight:bold">rem</span> <span style="color:#00D">-5</span> <span style="color:#00D">3</span>)
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>=&gt; <span style="color:#00D">-2</span>
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span><span style="color:#777">;; integer division: -5 = (3 * -2) + 1</span>
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span><span style="color:#777">;; -2 is closer to negative infinity than the -1 quotient provided by `rem`</span>
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>(<span style="color:#080;font-weight:bold">mod</span> <span style="color:#00D">-5</span> <span style="color:#00D">3</span>)
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>=&gt; <span style="color:#00D">1</span>
<span class="line-numbers"><a href="#n13" name="n13">13</a></span>
<span class="line-numbers"><a href="#n14" name="n14">14</a></span><span style="color:#777">;; + / - positive numerator, negative divisor</span>
<span class="line-numbers"><a href="#n15" name="n15">15</a></span>
<span class="line-numbers"><a href="#n16" name="n16">16</a></span><span style="color:#777">;; integer division: 5 = (-3 * -1) + 2</span>
<span class="line-numbers"><a href="#n17" name="n17">17</a></span>(<span style="color:#080;font-weight:bold">rem</span> <span style="color:#00D">5</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"><a href="#n18" name="n18">18</a></span>=&gt; <span style="color:#00D">2</span>
<span class="line-numbers"><a href="#n19" name="n19">19</a></span>
<span class="line-numbers"><strong><a href="#n20" name="n20">20</a></strong></span><span style="color:#777">;; integer division: 5 = (-3 * -2) + (-1)</span>
<span class="line-numbers"><a href="#n21" name="n21">21</a></span><span style="color:#777">;; -2 is closer to negative infinity than the -1 quotient provided by `rem`</span>
<span class="line-numbers"><a href="#n22" name="n22">22</a></span>(<span style="color:#080;font-weight:bold">mod</span> <span style="color:#00D">5</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"><a href="#n23" name="n23">23</a></span>=&gt; <span style="color:#00D">-1</span>
</pre></div>
</div>
</div>

<h2 id="use-case-bucketing-values">Use case: bucketing values</h2>

<p>Remainders are a way for us to identify groups of numbers.</p>

<div class="language-clojure highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span>(<span style="color:#080;font-weight:bold">mod</span> <span style="color:#00D">3</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>=&gt; <span style="color:#00D">0</span>
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>(<span style="color:#080;font-weight:bold">mod</span> <span style="color:#00D">2</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>=&gt; <span style="color:#00D">-1</span>
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>(<span style="color:#080;font-weight:bold">mod</span> <span style="color:#00D">1</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>=&gt; <span style="color:#00D">-2</span>
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>(<span style="color:#080;font-weight:bold">mod</span> <span style="color:#00D">0</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>=&gt; <span style="color:#00D">0</span>
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>
<span class="line-numbers"><a href="#n13" name="n13">13</a></span>(<span style="color:#080;font-weight:bold">mod</span> <span style="color:#00D">-1</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"><a href="#n14" name="n14">14</a></span>=&gt; <span style="color:#00D">-1</span>
</pre></div>
</div>
</div>

<p>You can see a pattern emerge in the remainders. Because we're dividing by -3, our remainder can only ever be between 0 and -3. We can group {0, 3} together because they both have remainder 0 when divided by -3, same with {-1, 2}.</p>

<p>Doesn't <code>rem</code> do the same thing?</p>

<div class="language-clojure highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span>(<span style="color:#080;font-weight:bold">rem</span> <span style="color:#00D">3</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>=&gt; <span style="color:#00D">0</span>
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>(<span style="color:#080;font-weight:bold">rem</span> <span style="color:#00D">2</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>=&gt; <span style="color:#00D">2</span>
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>(<span style="color:#080;font-weight:bold">rem</span> <span style="color:#00D">1</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>=&gt; <span style="color:#00D">1</span>
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>(<span style="color:#080;font-weight:bold">rem</span> <span style="color:#00D">0</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>=&gt; <span style="color:#00D">0</span>
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>
<span class="line-numbers"><a href="#n13" name="n13">13</a></span>(<span style="color:#080;font-weight:bold">rem</span> <span style="color:#00D">-1</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"><a href="#n14" name="n14">14</a></span>=&gt; <span style="color:#00D">-1</span>
<span class="line-numbers"><a href="#n15" name="n15">15</a></span>
<span class="line-numbers"><a href="#n16" name="n16">16</a></span>(<span style="color:#080;font-weight:bold">rem</span> <span style="color:#00D">-2</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"><a href="#n17" name="n17">17</a></span>=&gt; <span style="color:#00D">-2</span>
</pre></div>
</div>
</div>

<p>Nope! Because <code>rem</code> is flooring to zero, it starts a new cycle of remainders when it passes 0. -1 and 2 are no longer in the same group.</p>

<p>Why would we want to group numbers based on their remainders?</p>

<h2 id="use-case-limiting-a-function-range">Use case: limiting a function range</h2>

<p>This morning, I happened across this basic Clojure exercise:</p>

<blockquote>
  <p>Using REPL documentation functions, find the documentation for the rem and mod functions. Compare the results of the provided expressions based on the documentation.</p>
</blockquote>

<p>from: <a href="https://clojure.org/guides/learn/syntax">https://clojure.org/guides/learn/syntax</a></p>

<p><code>rem</code> is "…the integer "left over" after dividing one integer by another to produce an integer quotient (integer division)."</p>

<p><code>mod</code> stands for modulus or modulo operation which is defined as "… the operation that produces such a remainder when given a dividend and divisor."</p>

<p>Sounds like <code>rem</code> and <code>mod</code> do the same thing, so what's the difference?</p>

<p>Turns out this question is asked a lot in programming because functions for remainder and modulus vary between language. Language designers had to make a choice about how to implement these mathematical concepts.</p>

<p>I don't remember learning multiple ways to calculate a remainder in school so I did some digging. The following is a summary of what I learned. I tried to keep it easy-to-understand and memorable so that I won't forget it a second time.</p>

<p>You can skip the refresher on integer division if you just want to know what the difference is between <code>rem</code> and <code>mod</code> in Clojure.</p>

<p>My main source of understanding came from <a href="https://blogs.msdn.microsoft.com/ericlippert/2011/12/05/whats-the-difference-remainder-vs-modulus/">an excellent run down by Eric Lippert on the Microsoft Developer blog from 2011.</a></p>

<h2 id="why-do-we-divide-things">Why do we divide things?</h2>

<p>Division is dividing something up into equal parts. 10 pies divided amongst 4 people means each person can have 2.5 pies. That's great. We're all happy.</p>

<p>Sometimes the objects we're dividing aren't useful when we cut them into parts. Half a pie is still tasty but half an iPhone is not usable.</p>

<p>If we have 5 iPhones and 3 people, how many iPhones can each person have so that each person has the same number of iPhones?</p>

<p>Remember, we want to make sure each person has an equal amount, to avoid fighting.</p>

<p>When we have more objects than people, then we have leftover iPhones, a remainder.</p>

<blockquote>
  <p>5 / 3 = 1 iPhone per person, with 2 leftover iPhones.</p>

  <p>5 / 3 = 1, remainder 2.</p>
</blockquote>

<p>We can flip this equation around to say:</p>

<blockquote>
  <p>(1 iPhone per person * 3 people) + 2 leftover iPhones = 5 iPhones.</p>

  <p>(1 * 3) + 2 = 5</p>
</blockquote>

<p>Following this algorithm, we can generate other valid solutions.</p>

<blockquote>
  <p>(2 iPhones per person * 3 people) + 1 missing iPhone = 5 iPhones</p>

  <p>(2 * 3) + (-1) = 5</p>
</blockquote>

<blockquote>
  <p>(-1 iPhones per person * -3 people) + 2 iPhones = 5 iPhones</p>

  <p>(-1 * -3) + 2 = 5</p>
</blockquote>

<h2 id="negative-remainders">Negative remainders</h2>

<p>When we're out in the world dividing up pies and iPhones, the leftover, or remainder, is always positive. We don't have negative pies or iPhones, or do we?</p>

<p>Wouldn't it also be true to say, that each person could have 2 iPhones but one person would have to give up one of their two iPhones?</p>

<blockquote>
  <p>(2 iPhones per person * 3 people) + (-1 iPhone) = 5 iPhones.</p>

  <p>(2 * 3) + (-1) = 5</p>
</blockquote>

<p>or</p>

<blockquote>
  <p>5 iPhones divided by 3 people = 2 iPhones per person, with one iPhone returned.</p>

  <p>5 / 3 = 2, remainder -1.</p>
</blockquote>

<p>This is conceptually possible (being short an iPhone) and mathematically correct.</p>

<p>I don't know about you, but I'd prefer to tell my friends they can each have one iPhone and hide the extras rather than tell them they are entitled to two as long as we agree that someone won't get their second.</p>

<p>There are endless other solutions that are less useful. For example, 5 / 3 = 20, remainder -55. I give each of you 20 iPhones but altogether you've got to give me 55 of them back? It works on paper but…</p>

<h2 id="choosing-a-solution">Choosing a Solution</h2>

<p>I've been talking about iPhones because I want to convince you that there are many possible solutions. We don't think about it much because we have a preference for certain solutions over others.</p>

<p>How do you choose a solution?</p>

<p>In the above scenario, my preferred remainder is:</p>

<ul>
  <li>positive (To maintain peace and keep things simple.)</li>
  <li>small (I can't afford 60 iPhones even if I'm going to return 55.)</li>
</ul>

<p>This matches what mathematicians use to define integer division.</p>

<p>The answer should be the <strong>least positive remainder.</strong></p>

<h2 id="what-about-negative-numbers">What about negative numbers?</h2>

<p>We can consider a negative iPhone is an iPhone owed, lent, or given away.</p>

<p>Imagine we can construct a mega iPhone from 5 iPhones. I'll call it a MEGAPhone. I need convince my friends to lend me their iPhones so I can create a MEGAPhone.</p>

<p>We could have:</p>

<blockquote>
  <p>1) -5 / 3 = -1, remainder -2</p>

  <p>3 people contribute 1 iPhone each and we're still 2 iPhones short for our MEGAPhone.</p>
</blockquote>

<p>Or maybe…</p>

<blockquote>
  <p>2) -5 / 3 = -2, remainder 1</p>

  <p>3 people contribute 2 iPhones each for a total of 6 loaned iPhones, which is 1 iPhone more than we needed.</p>
</blockquote>

<p>What if we flip the signs of our numbers?</p>

<blockquote>
  <p>3) 5 / -3 = -1, remainder 2</p>
</blockquote>

<blockquote>
  <p>4) 5 / -3 = -2, remainder -1</p>
</blockquote>

<p>Frankly, I don't know how to explain what the above equations mean in real-world terms. We'll come to a better example of a negative divisor in minute.</p>

<h2 id="choosing-a-solution-again">Choosing a Solution Again</h2>

<p>Which solution should I choose?</p>

<p>In this example, I'd rather not be short an iPhone because the MEGAPhone isn't a MEGAPhone with just 4 loaned iPhones.</p>

<p>That means I use either</p>

<blockquote>
  <p>2) -5 / 3 = -2, remainder 1</p>
</blockquote>

<p>or</p>

<blockquote>
  <p>4) 5 / -3 = -2, remainder -1</p>
</blockquote>

<p>But imagine I can only get 1 iPhone from each friend. Then I need to know, "How many iPhones do I need to provide personally?" In that case, I want to know that I am 2 iPhones short, remainder -2.</p>

<p>If we go back to the mathematicians, they further define integer division as returning the least <strong>absolute</strong> remainder.</p>

<p>The mathematicians prefer that I ask my friends for 2 iPhones each so that I have one extra.</p>

<h2 id="why-doesnt-this-sound-like-what-i-was-taught-in-school">Why doesn't this sound like what I was taught in school?</h2>

<p>To be honest, all I remember is carrying out long division on positive integers and having a remainder.</p>

<p>I can't recall anything about finding the <strong>least absolute remainder.</strong></p>

<p>Do you remember learning that there are multiple ways to divide a number when you can play with the remainder? Or that you should take the absolute value of your remainder?</p>

<p>Let me know, I'm curious what you remember from school.</p>

<h2 id="the-difference-between-rem-and-mod-in-clojure">The difference between <code>rem</code> and <code>mod</code> in Clojure</h2>

<p>I'll run a couple experiments to show the difference before I talk about it.</p>

<div class="language-clojure highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span><span style="color:#777">;; positive numerator, positive divisor</span>
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>(<span style="color:#080;font-weight:bold">rem</span> <span style="color:#00D">5</span> <span style="color:#00D">3</span>)
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>=&gt; <span style="color:#00D">2</span>
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>(<span style="color:#080;font-weight:bold">mod</span> <span style="color:#00D">5</span> <span style="color:#00D">3</span>)
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>=&gt; <span style="color:#00D">2</span>
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span><span style="color:#777">;; negative numerator, positive divisor</span>
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>(<span style="color:#080;font-weight:bold">rem</span> <span style="color:#00D">-5</span> <span style="color:#00D">3</span>)
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>=&gt; <span style="color:#00D">-2</span>
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>(<span style="color:#080;font-weight:bold">mod</span> <span style="color:#00D">-5</span> <span style="color:#00D">3</span>)
<span class="line-numbers"><a href="#n13" name="n13">13</a></span>=&gt; <span style="color:#00D">1</span>
<span class="line-numbers"><a href="#n14" name="n14">14</a></span>
<span class="line-numbers"><a href="#n15" name="n15">15</a></span><span style="color:#777">;; positive numerator, negative divisor</span>
<span class="line-numbers"><a href="#n16" name="n16">16</a></span>(<span style="color:#080;font-weight:bold">rem</span> <span style="color:#00D">5</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"><a href="#n17" name="n17">17</a></span>=&gt; <span style="color:#00D">2</span>
<span class="line-numbers"><a href="#n18" name="n18">18</a></span>
<span class="line-numbers"><a href="#n19" name="n19">19</a></span>(<span style="color:#080;font-weight:bold">mod</span> <span style="color:#00D">5</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"><strong><a href="#n20" name="n20">20</a></strong></span>=&gt; <span style="color:#00D">-1</span>
<span class="line-numbers"><a href="#n21" name="n21">21</a></span>
<span class="line-numbers"><a href="#n22" name="n22">22</a></span><span style="color:#777">;; negative numerator, negative divisor</span>
<span class="line-numbers"><a href="#n23" name="n23">23</a></span>(<span style="color:#080;font-weight:bold">rem</span> <span style="color:#00D">-5</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"><a href="#n24" name="n24">24</a></span>=&gt; <span style="color:#00D">-2</span>
<span class="line-numbers"><a href="#n25" name="n25">25</a></span>
<span class="line-numbers"><a href="#n26" name="n26">26</a></span>(<span style="color:#080;font-weight:bold">mod</span> <span style="color:#00D">-5</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"><a href="#n27" name="n27">27</a></span>=&gt; <span style="color:#00D">-2</span>
<span class="line-numbers"><a href="#n28" name="n28">28</a></span>
<span class="line-numbers"><a href="#n29" name="n29">29</a></span><span style="color:#777">;; also note the zero cases</span>
<span class="line-numbers"><strong><a href="#n30" name="n30">30</a></strong></span>(<span style="color:#080;font-weight:bold">rem</span> <span style="color:#00D">-5</span> <span style="color:#00D">0</span>)
<span class="line-numbers"><a href="#n31" name="n31">31</a></span>=&gt; java.lang.ArithmeticException<span style="color:#F00;background-color:#FAA">:</span> <span style="color:#080;font-weight:bold">/</span> by zero
<span class="line-numbers"><a href="#n32" name="n32">32</a></span>
<span class="line-numbers"><a href="#n33" name="n33">33</a></span>(<span style="color:#080;font-weight:bold">mod</span> <span style="color:#00D">-5</span> <span style="color:#00D">0</span>)
<span class="line-numbers"><a href="#n34" name="n34">34</a></span>=&gt; java.lang.ArithmeticException<span style="color:#F00;background-color:#FAA">:</span> Divide by zero
<span class="line-numbers"><a href="#n35" name="n35">35</a></span>
<span class="line-numbers"><a href="#n36" name="n36">36</a></span><span style="color:#777">;; I'm not sure yet why one error uses `/` and the other uses `Divide`, feel free to email me if you have an idea or the answer.</span>
</pre></div>
</div>
</div>

<p><code>rem</code> and <code>mod</code> act the same when the numerator and divisor are the same sign (negative or positive).</p>

<p>Why do they act differently when the numerator and divisor have opposing signs?</p>

<p>Let's investigate the source code.</p>

<div class="language-clojure highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span>(source <span style="color:#080;font-weight:bold">rem</span>)
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>(<span style="color:#080;font-weight:bold">defn</span> <span style="color:#06B;font-weight:bold">rem</span>
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>  <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">remainder of dividing numerator by denominator.</span><span style="color:#710">&quot;</span></span>
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>  {<span style="color:#A60">:added</span> <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1.0</span><span style="color:#710">&quot;</span></span>
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>   <span style="color:#A60">:static</span> <span style="color:#069">true</span>
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>   <span style="color:#A60">:inline</span> (<span style="color:#080;font-weight:bold">fn</span> [x y] `(<span style="color:#080;font-weight:bold">.</span> clojure.lang.Numbers (remainder ~x ~y)))}
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>  [<span style="color:#080;font-weight:bold">num</span> div]
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>    (<span style="color:#080;font-weight:bold">.</span> clojure.lang.Numbers (remainder <span style="color:#080;font-weight:bold">num</span> div)))
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>=&gt; <span style="color:#069">nil</span>
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>(source <span style="color:#080;font-weight:bold">mod</span>)
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>(<span style="color:#080;font-weight:bold">defn</span> <span style="color:#06B;font-weight:bold">mod</span>
<span class="line-numbers"><a href="#n13" name="n13">13</a></span>  <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Modulus of num and div. Truncates toward negative infinity.</span><span style="color:#710">&quot;</span></span>
<span class="line-numbers"><a href="#n14" name="n14">14</a></span>  {<span style="color:#A60">:added</span> <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1.0</span><span style="color:#710">&quot;</span></span>
<span class="line-numbers"><a href="#n15" name="n15">15</a></span>   <span style="color:#A60">:static</span> <span style="color:#069">true</span>}
<span class="line-numbers"><a href="#n16" name="n16">16</a></span>  [<span style="color:#080;font-weight:bold">num</span> div]
<span class="line-numbers"><a href="#n17" name="n17">17</a></span>  (<span style="color:#080;font-weight:bold">let</span> [m (<span style="color:#080;font-weight:bold">rem</span> <span style="color:#080;font-weight:bold">num</span> div)]
<span class="line-numbers"><a href="#n18" name="n18">18</a></span>    (<span style="color:#080;font-weight:bold">if</span> (<span style="color:#080;font-weight:bold">or</span> (<span style="color:#080;font-weight:bold">zero?</span> m) (<span style="color:#080;font-weight:bold">=</span> (<span style="color:#080;font-weight:bold">pos?</span> <span style="color:#080;font-weight:bold">num</span>) (<span style="color:#080;font-weight:bold">pos?</span> div)))
<span class="line-numbers"><a href="#n19" name="n19">19</a></span>      m
<span class="line-numbers"><strong><a href="#n20" name="n20">20</a></strong></span>      (<span style="color:#080;font-weight:bold">+</span> m div))))
<span class="line-numbers"><a href="#n21" name="n21">21</a></span>=&gt; <span style="color:#069">nil</span>
</pre></div>
</div>
</div>

<p>Discussing the source of <code>rem</code> is beyond the scope of this article. The implementation of <code>rem</code> was set first, and <code>mod</code> was created to offer a different choice in case the definition of <code>rem</code> doesn't suit your purposes.</p>

<p>Let's look at how <code>mod</code> utilizes <code>rem</code> and what creates the difference.</p>

<div class="language-clojure highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"><a href="#n1" name="n1">1</a></span>(<span style="color:#080;font-weight:bold">let</span> [m (<span style="color:#080;font-weight:bold">rem</span> <span style="color:#080;font-weight:bold">num</span> div)]
<span class="line-numbers"><a href="#n2" name="n2">2</a></span>    (<span style="color:#080;font-weight:bold">if</span> (<span style="color:#080;font-weight:bold">or</span> (<span style="color:#080;font-weight:bold">zero?</span> m) (<span style="color:#080;font-weight:bold">=</span> (<span style="color:#080;font-weight:bold">pos?</span> <span style="color:#080;font-weight:bold">num</span>) (<span style="color:#080;font-weight:bold">pos?</span> div)))
<span class="line-numbers"><a href="#n3" name="n3">3</a></span>      m
<span class="line-numbers"><a href="#n4" name="n4">4</a></span>      (<span style="color:#080;font-weight:bold">+</span> m div))))
</pre></div>
</div>
</div>

<p><code>mod</code> considers three cases. Here are the first two:</p>

<ul>
  <li>the remainder is 0 =&gt; just return 0, end of story</li>
  <li>the numerator and divisor are the same sign (either both positive or both negative) =&gt; return the remainder; act just like <code>rem</code></li>
</ul>

<p>Thirdly, the else case. After eliminating the first two cases, we have a non-zero remainder and the numerator and divisor have opposing signs.</p>

<p>In this else case, <code>(+ m div)</code>, add the divisor to the remainder.</p>

<div class="language-clojure highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span><span style="color:#777">;; negative numerator, positive divisor</span>
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>(<span style="color:#080;font-weight:bold">rem</span> <span style="color:#00D">-5</span> <span style="color:#00D">3</span>)
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>=&gt; <span style="color:#00D">-2</span>
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>(<span style="color:#080;font-weight:bold">mod</span> <span style="color:#00D">-5</span> <span style="color:#00D">3</span>)
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span><span style="color:#777">;; (+ (rem -5 3) 3)</span>
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span><span style="color:#777">;; (+ -2 3)</span>
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>=&gt; <span style="color:#00D">1</span>
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span><span style="color:#777">;; positive numerator, negative divisor</span>
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>(<span style="color:#080;font-weight:bold">rem</span> <span style="color:#00D">5</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>=&gt; <span style="color:#00D">2</span>
<span class="line-numbers"><a href="#n13" name="n13">13</a></span>
<span class="line-numbers"><a href="#n14" name="n14">14</a></span>(<span style="color:#080;font-weight:bold">mod</span> <span style="color:#00D">5</span> <span style="color:#00D">-3</span>)
<span class="line-numbers"><a href="#n15" name="n15">15</a></span><span style="color:#777">;; (+ (rem 5 -3) -3)</span>
<span class="line-numbers"><a href="#n16" name="n16">16</a></span><span style="color:#777">;; (+ 2 -3)</span>
<span class="line-numbers"><a href="#n17" name="n17">17</a></span>=&gt; <span style="color:#00D">-1</span>
</pre></div>
</div>
</div>

<p>As a result, <code>mod</code> gives us a least absolute remainder.</p>

<p>I actually don't have a nice way to wrap this up. From what I can tell, <code>mod</code> aligns with Wikipedia and Wolfram Alpha, which must be the indisputably true way.</p>

<p>So, how did <code>rem</code> originate? Why can <code>mod</code> rely on this simple bit of addition to create a least absolute remainder from <code>rem</code>?</p>

<p>Stay tuned.</p>
</div></div></div><div class="footer"><div class="nav"><ul>
  <li><a href="/index.html">Home</a></li>
  <li><a href="/writing/index.html">Writings</a></li>
</ul>
</div><p>Email me at: <a href="mailto:nicki@boxingindustries.com">nicki@boxingindustries.com</a></p>
</div></body></html><footer><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-90558965-3', 'auto');
ga('send', 'pageview');</script></footer>